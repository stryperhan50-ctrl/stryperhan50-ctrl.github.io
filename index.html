
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>마음의 평화 생성기</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
    body {
        font-family: 'Inter', sans-serif;
        background-color: #0c0a09;
        color: #d4d4d4;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        text-align: center;
        transition: background-color 2s ease;
    }
    .container {
        position: relative;
        z-index: 10;
    }
    .container-glow {
        box-shadow: 0 0 50px rgba(79, 70, 229, 0.4);
        transition: box-shadow 0.5s ease-in-out;
    }
    .container-glow:hover {
        box-shadow: 0 0 70px rgba(79, 70, 229, 0.6);
    }
    .btn-play {
        transition: transform 0.3s ease, background-color 0.3s ease;
    }
    .btn-play:hover {
        transform: scale(1.05);
    }
</style>
<!-- Tone.js 라이브러리 로드 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>
</head>
<body class="bg-gray-950 text-gray-200">
<!-- 마음의 평화를 위한 UI -->
<div class="container p-8 rounded-3xl container-glow max-w-lg mx-auto">
    <h1 class="text-4xl font-bold mb-4 text-white">마음의 평화</h1>
    <p class="text-gray-400 mb-8">
        깊은 숨을 들이쉬고, 모든 걱정을 잠시 내려놓으세요.
    </p>

    <button id="toggleButton" class="btn-play bg-indigo-600 text-white font-semibold py-3 px-8 rounded-full shadow-lg hover:bg-indigo-700">
        <svg id="playIcon" class="w-6 h-6 inline-block mr-2" fill="currentColor" viewBox="0 0 20 20">
            <path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"></path>
        </svg>
        <svg id="pauseIcon" class="w-6 h-6 inline-block mr-2 hidden" fill="currentColor" viewBox="0 0 20 20">
            <path d="M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z"></path>
        </svg>
        <span id="buttonText">재생하기</span>
    </button>

    <p class="text-sm text-gray-500 mt-6">
        걱정을 잠시 내려놓으세요
    </p>
</div>

<!-- 스크립트: 오디오와 UI 제어 -->
<script>
    let isPlaying = false;
    let toneLoop;
    const toggleButton = document.getElementById('toggleButton');
    const buttonText = document.getElementById('buttonText');
    const playIcon = document.getElementById('playIcon');
    const pauseIcon = document.getElementById('pauseIcon');

    // Tone.js를 사용하여 부드러운 앰비언트 사운드 생성
    const synth = new Tone.PolySynth(Tone.Synth, {
        oscillator: { type: "sine" },
        envelope: {
            attack: 4,
            decay: 0.5,
            sustain: 0.5,
            release: 5
        }
    }).toDestination();

    // 반복될 노트 시퀀스 정의
    const notes = [
        ["C3", "E3", "G3"],
        ["G3", "B3", "D4"],
        ["D3", "F#3", "A3"],
        ["A3", "C4", "E4"]
    ];

    // 오디오 재생 및 중지
    async function toggleAudio() {
        // 브라우저의 오디오 정책을 준수하기 위해 사용자 클릭 시 Tone.start() 호출
        await Tone.start();

        if (isPlaying) {
            // 이미 재생 중이면, 루프와 트랜스포트를 멈춥니다.
            if (toneLoop) {
                toneLoop.stop();
                toneLoop.dispose(); // 루프 리소스 해제
            }
            Tone.Transport.stop(); // 트랜스포트 중지
            buttonText.textContent = "재생하기";
            playIcon.classList.remove('hidden');
            pauseIcon.classList.add('hidden');
        } else {
            // 새로운 루프를 생성하고 트랜스포트를 시작합니다.
            Tone.Transport.start();

            // 2초마다 화음이 재생되도록 스케줄링합니다.
            toneLoop = new Tone.Loop(time => {
                const noteSet = notes[Math.floor(Math.random() * notes.length)];
                synth.triggerAttackRelease(noteSet, "2n", time);
            }, "2n").start(0);

            buttonText.textContent = "일시정지";
            playIcon.classList.add('hidden');
            pauseIcon.classList.remove('hidden');
        }
        isPlaying = !isPlaying;
    }

    toggleButton.addEventListener('click', toggleAudio);
</script>
</body>
</html>
